#!/usr/bin/env node
'use strict';

const fs = require('fs');
const path = require('path');

const Compiler = require('../compiler');
const compiler = new Compiler(__dirname);

let bundled = `(() => {
'use strict';
const exports = {};
`;
// Typescript is obnoxiously adding spaces for no apparent reason...
const json = fs.readFileSync(path.resolve(__dirname, 'src/data/data.json'), 'utf8');
bundled += `const DATA = ${json};\n`;
bundled += compiler.read('data/index.js', 11, 1);
bundled += compiler.read('adaptable.js', 2, 1);
bundled += `
// EXPORTS
window.PokemonSprites = new exports.Sprites(exports.Data);
window.PokemonSprites.SOURCES = exports.Sprites.SOURCES;
window.PokemonSprites.GENS = exports.Sprites.GENS;
window.PokemonSprites.ANIMATED = exports.Sprites.ANIMATED;
window.PokemonSprites.FRAME2 = exports.Sprites.FRAME2;
window.PokemonIcons = new exports.Icons(exports.Data);
})();`
compiler.compile(bundled);